#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ R —Å Telegram ID –≤ —ç–∫—Å–ø–æ—Ä—Ç Google Sheets
"""

from social_bookings_export import export_social_booking_to_sheets, export_guest_booking_to_sheets

def test_admin_booking_export():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç –∞–¥–º–∏–Ω—Å–∫–æ–π –∑–∞—è–≤–∫–∏ —Å Telegram ID"""
    print("üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º —ç–∫—Å–ø–æ—Ä—Ç –∞–¥–º–∏–Ω—Å–∫–æ–π –∑–∞—è–≤–∫–∏ —Å Telegram ID –≤ –∫–æ–ª–æ–Ω–∫—É R...")
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∞–¥–º–∏–Ω—Å–∫–æ–π –∑–∞—è–≤–∫–∏
    booking_data = {
        'name': '–¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤–∏—á',
        'phone': '+7 (999) 123-45-67',
        'date': '–∑–∞–≤—Ç—Ä–∞',
        'time': '19:00',
        'guests': '2',
        'reason': '–î–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è',
        'source': 'source_vk'
    }
    
    admin_id = 196614680  # Telegram ID –∞–¥–º–∏–Ω–∞
    
    print(f"–î–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏: {booking_data}")
    print(f"Telegram ID –∞–¥–º–∏–Ω–∞: {admin_id}")
    
    # –ü–æ–ø—Ä–æ–±—É–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã Google Sheets)
    try:
        result = export_social_booking_to_sheets(booking_data, admin_id)
        if result:
            print("‚úÖ –ê–¥–º–∏–Ω—Å–∫–∞—è –∑–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å Telegram ID –≤ –∫–æ–ª–æ–Ω–∫—É R!")
        else:
            print("‚ö†Ô∏è –≠–∫—Å–ø–æ—Ä—Ç –Ω–µ —É–¥–∞–ª—Å—è (–≤–æ–∑–º–æ–∂–Ω–æ, Google Sheets –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)")
    except Exception as e:
        print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ: {e}")

def test_guest_booking_export():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç –≥–æ—Å—Ç–µ–≤–æ–π –∑–∞—è–≤–∫–∏ —Å Telegram ID"""
    print("\nüß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º —ç–∫—Å–ø–æ—Ä—Ç –≥–æ—Å—Ç–µ–≤–æ–π –∑–∞—è–≤–∫–∏ —Å Telegram ID –≤ –∫–æ–ª–æ–Ω–∫—É R...")
    
    # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≥–æ—Å—Ç–µ–≤–æ–π –∑–∞—è–≤–∫–∏
    booking_data = {
        'name': '–ì–æ—Å—Ç—å –ì–æ—Å—Ç–µ–≤–∏—á',
        'phone': '+7 (999) 765-43-21',
        'date': '–ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞',
        'time': '20:30',
        'guests': '4',
        'reason': '–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤'
    }
    
    user_id = 208281210  # Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-–≥–æ—Å—Ç—è
    
    print(f"–î–∞–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏: {booking_data}")
    print(f"Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {user_id}")
    
    # –ü–æ–ø—Ä–æ–±—É–µ–º —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã Google Sheets)
    try:
        result = export_guest_booking_to_sheets(booking_data, user_id)
        if result:
            print("‚úÖ –ì–æ—Å—Ç–µ–≤–∞—è –∑–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å Telegram ID –≤ –∫–æ–ª–æ–Ω–∫—É R!")
        else:
            print("‚ö†Ô∏è –≠–∫—Å–ø–æ—Ä—Ç –Ω–µ —É–¥–∞–ª—Å—è (–≤–æ–∑–º–æ–∂–Ω–æ, Google Sheets –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)")
    except Exception as e:
        print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ: {e}")

def test_structure_verification():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—É"""
    print("\nüîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞...")
    
    # –≠–º—É–ª–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ row_data –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–æ–π –∑–∞—è–≤–∫–∏
    print("–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–æ–π –∑–∞—è–≤–∫–∏:")
    columns = [
        "A: –î–∞—Ç–∞ –ó–∞—è–≤–∫–∏", "B: –ò–º—è –ì–æ—Å—Ç—è", "C: –¢–µ–ª–µ—Ñ–æ–Ω", "D: –î–∞—Ç–∞ –ø–æ—Å–µ—â–µ–Ω–∏—è",
        "E: –í—Ä–µ–º—è", "F: –ö–æ–ª-–≤–æ –≥–æ—Å—Ç–µ–π", "G: –ò—Å—Ç–æ—á–Ω–∏–∫", "H: –¢–ï–ì –¥–ª—è –ê–ú–û",
        "I: –ü–æ–≤–æ–¥ –í–∏–∑–∏—Ç–∞", "J: –ö—Ç–æ —Å–æ–∑–¥–∞–ª –∑–∞—è–≤–∫—É", "K: –°—Ç–∞—Ç—É—Å",
        "L: UTM Source", "M: UTM Medium", "N: UTM Campaign",
        "O: UTM Content", "P: UTM Term", "Q: ID –∑–∞—è–≤–∫–∏",
        "R: Telegram ID —Å–æ–∑–¥–∞—Ç–µ–ª—è ‚ú®"  # –ù–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞!
    ]
    
    for i, column in enumerate(columns):
        print(f"  {column}")
    
    print(f"\n–í—Å–µ–≥–æ –∫–æ–ª–æ–Ω–æ–∫: {len(columns)}")
    print("‚úÖ –ö–æ–ª–æ–Ω–∫–∞ R (Telegram ID) —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É!")

if __name__ == "__main__":
    print("üöÄ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–ª–æ–Ω–∫–∏ R —Å Telegram ID")
    print("=" * 60)
    
    test_structure_verification()
    test_admin_booking_export()
    test_guest_booking_export()
    
    print("\n" + "=" * 60)
    print("üìã –ò–¢–û–ì: –ö–æ–ª–æ–Ω–∫–∞ R —Å Telegram ID —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!")
    print("üîó –¢–µ–ø–µ—Ä—å –≤ Google Sheets –±—É–¥–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ–∑–¥–∞–≤—à–µ–≥–æ –∑–∞—è–≤–∫—É")
