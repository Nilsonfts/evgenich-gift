# Новые источники трафика для бота Евгенич

## Список всех источников трафика

Обновленный список источников трафика для телеграм-бота `@evgenichspbbot`:

| Название источника | Код | Ссылка | Описание |
|-------------------|-----|---------|----------|
| QR-код на ТВ | `qr_tv` | `https://t.me/evgenichspbbot?start=qr_tv` | QR-код, показываемый на ТВ в заведении |
| QR-код на баре | `qr_bar` | `https://t.me/evgenichspbbot?start=qr_bar` | QR-код, размещенный на барной стойке |
| QR от официанта | `qr_waiter` | `https://t.me/evgenichspbbot?start=qr_waiter` | QR-код, который показывает официант |
| Ссылка из ВКонтакте | `vk` | `https://t.me/evgenichspbbot?start=vk` | Переходы из социальной сети ВКонтакте |
| Ссылка из Instagram | `inst` | `https://t.me/evgenichspbbot?start=inst` | Переходы из социальной сети Instagram |
| Меню в баре | `menu` | `https://t.me/evgenichspbbot?start=menu` | Ссылка в QR-коде на меню в баре |
| Листовка на улице | `flyer` | `https://t.me/evgenichspbbot?start=flyer` | Переходы с уличных листовок |
| Уличное Меню | `streat` | `https://t.me/evgenichspbot?start=streat` | Переходы с уличного меню |
| 2ГИС Кнопка | `2gis` | `https://t.me/evgenichspbbot?start=2gis` | Переходы из приложения 2ГИС |
| Кнопка Сайт | `site` | `https://t.me/evgenichspbbot?start=site` | Переходы с официального сайта |
| Таплинк на ТВ | `taplink` | `https://taplink.cc/evgenich.bar` | Переходы через Taplink (не прямая ссылка на бота) |

## Как добавить новый источник

### 1. Обновление кода обработчика

В файле `handlers/user_commands.py` в функции `handle_start()` обновите словарь `allowed_sources`:

```python
allowed_sources = {
    'qr_tv': 'QR-код на ТВ', 
    'qr_bar': 'QR-код на баре', 
    'qr_waiter': 'QR от официанта',
    'vk': 'Ссылка из ВКонтакте', 
    'inst': 'Ссылка из Instagram', 
    'menu': 'Меню в баре',
    'flyer': 'Листовка на улице', 
    'streat': 'Уличное Меню',
    '2gis': '2ГИС Кнопка',
    'site': 'Кнопка Сайт',
    'taplink': 'Таплинк на ТВ',
    # Здесь добавьте новый источник:
    'новый_код': 'Новое название источника'
}
```

### 2. Автоматическое отслеживание

После добавления в код, источники автоматически:
- ✅ Сохраняются в базе данных SQLite
- ✅ Отображаются в ежедневных отчетах
- ✅ Экспортируются в Google Sheets
- ✅ Учитываются в аналитике

### 3. Создание ссылок

Формат ссылки для нового источника:
```
https://t.me/evgenichspbbot?start=НОВЫЙ_КОД
```

## Отчетность

### Ежедневные отчеты
Все источники автоматически попадают в ежедневные отчеты в разделе "Источники подписчиков (общие)".

### Google Sheets
При экспорте данных все источники сохраняются в колонке "Источник Привлечения".

### Реферальная система
Сотрудники имеют отдельные QR-коды формата:
```
https://t.me/evgenichspbbot?start=w_КОД_СОТРУДНИКА
```

Они отображаются в отчетах как "Сотрудник: Имя" и учитываются отдельно.

## Тестирование

Для тестирования новых источников используйте файл `test_new_sources.py`:

```bash
python3 test_new_sources.py
```

Он создаст тестовых пользователей с разными источниками и покажет, как они отображаются в отчетах.

## Примечания

1. **Taplink** - особый случай, так как это внешний сервис. Переходы через Taplink могут не напрямую вести в бота.

2. **Регистр имеет значение** - коды источников должны точно совпадать в ссылках и в словаре `allowed_sources`.

3. **Статистика в реальном времени** - все новые пользователи с указанными источниками сразу попадают в отчеты.

4. **Совместимость** - система обратно совместима со старыми источниками.
